#!/usr/bin/env bash
# shellcheck disable=SC1090

set -eou pipefail

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
source "${DIR}/../dotfiles/.lib_sh/echos.sh"

[[ -n ${UNION_DEBUG:-} ]] && bot "Enabling debug mode" && set -x

function usage() {
  cat <<- EOF

  delete a repo

  usage: $0 <owner> <repo>

EOF
}

function main() {
  bot "attempting to delete github repo ${OWNER}/${REPO}"

  curl -X DELETE "${API_URL}/repos/${OWNER}/${REPO}" \
    -H "Authorization: token ${GH_TOKEN}" \
    --compressed | jq
}

banner

if [ "$#" -lt 1 ]; then usage; die; fi # if no parameters show usage and die

GH_TOKEN="$(head -n 1 $HOME/.github_token)"
API_URL="https://api.github.com"
OWNER="$1"
REPO="$2"

main "$@"
